{% extends 'layout.html.twig' %}

{% block content %}
<a href="http://mybox.pagodabox.com/connect"><button class="medium green col_4">Connect social network</button></a>
    <h1>Boxes</h1>
<div class="box_area">
<div id="boxes"></div>
<div class="box_area_clear"></div>
</div>

<script type="text/javascript">
$.getJSON("http://mybox.pagodabox.com/boxes",{},
  function(data) {
    $.each(data, function(i,item){

      console.log(item);

      var date = new Date(item.date * 1000);

      var itemData = '<div class="box_area_item">';

      itemData = itemData + '<i>At '+date.getDay()+'.'+date.getMonth()+'.'+date.getFullYear()+' '+date.getHours()+':'+date.getMinutes()+' from '+item.from+'</i>';

      itemData = itemData + '<p>'+item.text+'</p>';
	  
	  var atatchments = '';
	  
	  if( item.attachments.length > 0 ){
	  
		atatchments = atatchments + '<div class="attachments">';
		
		for( index in item.attachments){
		
			var att = item.attachments[index];
			
			if( att.type == 'video' ){
			    atatchments = atatchments + '<div class="item">';
				atatchments = atatchments + '<div class="full"><img src="'+att.src+'"/></div>';
				atatchments = atatchments + '<img src="'+att.image+'"/>';
				atatchments = atatchments + '<h1>'+att.title+'<h1>';
				atatchments = atatchments + '<p>'+att.description+'<p>';
			    atatchments = atatchments + '</div>';
			}
			
			if( att.type == 'photo' ){
				atatchments = atatchments + '<div class="item">';
                atatchments = atatchments + '<div class="full">'+att.src+'</div>';
				atatchments = atatchments + '<img src="'+att.image+'"/>';
				atatchments = atatchments + '<h1>'+att.title+'<h1>';
				atatchments = atatchments + '<p>'+att.description+'<p>';
				atatchments = atatchments + '</div>';
			}
			
			if( att.type == 'link' ){
				atatchments = atatchments + '<div class="item">';
				atatchments = atatchments + '<a href="'+att.src+'">'+att.src+'</a>';
				atatchments = atatchments + '<h1>'+att.title+'<h1>';
				atatchments = atatchments + '<p>'+att.description+'<p>';
				atatchments = atatchments + '</div>';
			}		
		}
		
		atatchments = atatchments + '</div>';
	  
	  }
	  
      itemData = itemData + attachments;
	  
      itemData = itemData + '<div class="rate">'+item.likes+'</div>';

      itemData = itemData + '</div>';

      $('#boxes').append(itemData);
    });
  });
</script>


{% endblock %}
